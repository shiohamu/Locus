# Phase3/Phase4 実装概要

## 1. 概要

Phase3/Phase4は将来の拡張機能として計画されている。Phase1、Phase2の安定化を優先し、必要に応じて段階的に実装する。

## 2. Phase3 対象機能

### 2.1 LLM機能

#### 目的
- ノート要約
- RSS記事要約
- 要点抽出

#### 実装方針
- オンライン時のみ有効
- 外部API（OpenAI、Anthropic等）またはローカルLLM（Ollama等）両対応可能な抽象化
- プラグイン的な設計で、LLMプロバイダーを切り替え可能にする

#### 技術的考慮事項
- LLM APIクライアントの抽象化レイヤー
- プロンプトテンプレート管理
- レート制限・エラーハンドリング
- コスト管理（外部API使用時）

#### 実装項目（将来）
- [x] LLMプロバイダー抽象化インターフェース
- [x] OpenAI API実装
- [x] Ollama API実装（ローカルLLM）
- [x] ノート要約API
- [x] RSS記事要約API
- [x] 要点抽出API
- [x] フロントエンドUI（要約表示、再生成）

### 2.2 自動タグ付け

#### 目的
- LLMまたはルールベースによるタグ候補生成
- ユーザー承認後に反映

#### 実装方針
- LLM機能と連携
- ルールベース（キーワード抽出、既存タグの類似度等）も併用
- ユーザー承認フローを明確にする

#### 実装項目（将来）
- [x] タグ候補生成サービス
- [x] LLMベースのタグ生成
- [x] ルールベースのタグ生成
- [x] タグ候補承認UI
- [x] タグ自動適用設定

### 2.3 知識グラフ拡張

#### 目的
- 双方向リンクの可視化
- タグ・リンクを用いた関係性表示

#### 実装方針
- グラフ可視化ライブラリの使用（D3.js、vis.js等）
- インタラクティブなグラフ表示
- ノード・エッジのフィルタリング

#### 実装項目（将来）
- [x] グラフデータ生成API
- [x] グラフ可視化コンポーネント
- [x] インタラクティブな操作（ズーム、パン、ノード選択）
- [x] フィルタリング機能（タグ、タイプ）

## 3. Phase4 対象機能

### 3.1 公開/Wiki機能

#### 目的
- ノート単位での公開設定
- 静的HTML出力
- 読み取り専用公開

#### 実装方針
- 公開設定フラグをデータモデルに追加
- 静的サイトジェネレーター的な機能
- 認証不要の読み取り専用アクセス

#### 技術的考慮事項
- 公開ノートのフィルタリング
- 静的HTML生成（SSG）
- デプロイ先の選択（GitHub Pages、Netlify、Vercel等）

#### 実装項目（将来）
- [x] 公開設定フラグ（`notes_core.public`）
- [x] 公開ノート一覧API
- [x] 静的HTML生成サービス
- [x] 公開サイト用のルーティング
- [x] テーマ・スタイリング
- [x] デプロイスクリプト

## 4. 実装優先順位

### Phase3
1. **LLM機能** - 要約・要点抽出の需要が高い
2. **自動タグ付け** - LLM機能と連携
3. **知識グラフ拡張** - 可視化の需要に応じて

### Phase4
1. **公開/Wiki機能** - 公開ニーズに応じて

## 5. 技術的考慮事項

### LLM機能
- **プロバイダー抽象化**: インターフェースを定義し、実装を切り替え可能にする
- **コスト管理**: 外部API使用時のコストを追跡・制限
- **レート制限**: API制限を考慮した実装
- **エラーハンドリング**: タイムアウト、レート制限、APIエラーの適切な処理

### 知識グラフ
- **パフォーマンス**: 大量のノート・リンクがある場合のパフォーマンス考慮
- **可視化ライブラリ**: 軽量でパフォーマンスの良いライブラリを選択
- **データ構造**: グラフデータの効率的な生成・キャッシュ

### 公開/Wiki機能
- **セキュリティ**: 公開データの適切なフィルタリング
- **パフォーマンス**: 静的HTML生成の効率化
- **デプロイ**: CI/CDパイプラインとの統合

## 6. 非目標（再確認）

以下の機能は実装しない：
- 複数ユーザー同時編集
- 権限管理・ロール管理
- 企業・組織利用を前提とした機能
- リアルタイムコラボレーション

## 7. 実装時の注意事項

- Phase1、Phase2の安定性を最優先
- 個人開発で破綻しない粒度でのみ拡張
- 各Phaseは独立して実装可能な設計
- 既存機能への影響を最小限に抑える
- 必要に応じて段階的に実装（全機能を一度に実装しない）

## 8. 将来の検討事項

### Phase3以降で検討
- バックグラウンドジョブ（RSS取得、Webクリップ取得等）
- 通知機能（新着RSS記事等）
- プラグインシステム（機能拡張のための仕組み）
- データインポート機能（他PKMツールからの移行）

### Phase4以降で検討
- カスタムドメイン対応
- テーマカスタマイズ
- コメント機能（公開ノートへのコメント）
- アクセス解析








